webpackJsonp([0],[function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function u(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(u,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,i&&(u=2&n[0]?i.return:n[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[2&n[0],u.value]),n[0]){case 0:case 1:u=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(u=c.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){c.label=n[1];break}if(6===n[0]&&c.label<u[1]){c.label=u[1],u=n;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(n);break}u[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(t){n=[6,t],i=0}finally{a=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,i,u,s,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},i=this;Object.defineProperty(e,"__esModule",{value:!0});var u,s=n(2),c=function(){var t=document.createElement("canvas");t.width=s.state.display.width,t.height=s.state.display.height,document.body.appendChild(t),u=t.getContext("2d")},o=function(){if(s.state.isDrawing){var t=u.getImageData(0,0,s.state.display.width,s.state.display.height),e=[0,255,0],n=[0,0,0];s.state.display.content.forEach(function(r,a){var i=4*a,u=r?e:n;t.data[i]=u[0],t.data[i+1]=u[1],t.data[i+2]=u[2],t.data[i+3]=255}),u.putImageData(t,0,0),s.state.isDrawing=!1}};e.readProgram=function(t){return r(i,void 0,void 0,function(){var e,n,r;return a(this,function(a){switch(a.label){case 0:return[4,fetch(t)];case 1:return e=a.sent(),[4,e.arrayBuffer()];case 2:return n=a.sent(),r=new Uint8Array(n),s.loadProgram(r),[2]}})})};(function(){r(i,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return s.init(),c(),[4,e.readProgram("./tetris.rom")];case 1:return n.sent(),t=0,setInterval(function(){s.nextCommand(),o(),++t%6==0&&s.state.delayTimer>0&&s.state.delayTimer--},0),[2]}})})})()},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),i=function(t){return new Array(t).fill(0)},u=function(){return a.keys.reduce(function(t,e,n){var a;return r({},t,(a={},a[n]=!1,a))},{})};e.initialState=function(){var t=new Uint8Array(new ArrayBuffer(4096)).fill(0);return t.set(a.chars),{sp:0,I:0,pc:512,stack:i(16),memory:t,keys:u(),delayTimer:0,soundTimer:0,V:i(16),display:{width:64,height:32,content:i(2048)},isDrawing:!1}},e.loadProgram=function(t){for(var n=0;n<t.length;n++)e.state.memory[n+512]=t[n]},e.state=e.initialState(),e.init=function(t){return void 0===t&&(t={}),e.state=r({},e.initialState(),t)};var s=function(t,n){var r=e.state.display,a=r.width,i=r.height,u=r.content;t>a?t-=a:t<0&&(t+=a),n>i?n-=i:n<0&&(n+=i);var s=t+n*a;return u[s]^=1,!u[s]},c=function(t){return(3840&t)>>8},o=function(t){return e.state.V[c(t)]},f=function(t){return(240&t)>>4},l=function(t){return e.state.V[f(t)]},d=function(t){return 15&t},v=function(t){return 255&t},p=function(t){return 4095&t},h=function(t,n){return e.state.V[15]=+n(o(t),l(t))},y=function(t,n){var r=c(t),a=n(e.state.V[r],l(t));e.state.V[r]=a+(a<0?256:a>255?-256:0)},b=function(t,n){return e.state.I=n(o(t),e.state.I)},m=function(t,n){return e.state.pc+=n(o(t),l(t))?2:0};e.nextCommand=function(){return e.run(e.state.memory[e.state.pc]<<8|e.state.memory[e.state.pc+1])},e.run=function(t){switch(e.state.pc+=2,61440&t){case 0:switch(t){case 224:return void e.state.display.content.fill(0);case 238:return e.state.sp--,void(e.state.pc=e.state.stack[e.state.sp])}break;case 4096:e.state.pc=p(t);break;case 8192:e.state.stack[e.state.sp]=e.state.pc,e.state.sp++,e.state.pc=p(t);break;case 12288:m(t,function(e){return e===v(t)});break;case 16384:m(t,function(e){return e!==v(t)});break;case 20480:m(t,function(t,e){return t===e});break;case 24576:y(t,function(){return v(t)});break;case 28672:y(t,function(e){return e+v(t)});break;case 32768:switch(15&t){case 0:return void y(t,function(t,e){return e});case 1:return void y(t,function(t,e){return t|e});case 2:return void y(t,function(t,e){return t&e});case 3:return void y(t,function(t,e){return t^e});case 4:return h(t,function(t,e){return t+e>255}),void y(t,function(t,e){return t+e});case 5:return h(t,function(t,e){return t>e}),void y(t,function(t,e){return t-e});case 6:return h(t,function(t){return 1&t}),void y(t,function(t){return t>>1});case 7:return h(t,function(t,e){return e>t}),void y(t,function(t,e){return e-t});case 14:return h(t,function(t){return 240&t}),void y(t,function(t){return t<<1})}break;case 36864:m(t,function(t,e){return t!==e});break;case 40960:b(t,function(){return p(t)});break;case 45056:e.state.pc=p(t)+e.state.V[0];break;case 49152:y(t,function(){return~~(255*Math.random())&v(t)});break;case 53248:var n=e.state.I,r=e.state.V,a=e.state.memory,i=o(t),u=l(t),f=d(t);r[15]=0;for(var w=0;w<f;w++)for(var k=a[n+w],g=0;g<8;g++)(128&k)>0&&s(i+g,u+w)&&(r[15]=1),k<<=1;e.state.isDrawing=!0;break;case 57344:switch(255&t){case 158:return void m(t,function(t){return e.state.keys[t]});case 161:return void m(t,function(t){return!e.state.keys[t]})}break;case 61440:switch(255&t){case 7:return void y(t,function(){return e.state.delayTimer});case 10:for(var _=!1,I=0;I<16;++I)e.state.keys[I]&&(e.state.V[c(t)]=I,_=!0);return void(_||(e.state.pc-=2));case 21:return void(e.state.delayTimer=o(t));case 24:return void(e.state.soundTimer=o(t));case 30:return e.state.V[15]=+(e.state.I+o(t)>4095),void b(t,function(t,e){return t+e});case 41:return void b(t,function(t){return 5*t});case 51:var a=e.state.memory,n=e.state.I,i=o(t);return a[n+2]=i%10,a[n+1]=~~(i/10)%10,void(a[n]=~~(i/100)%10);case 85:case 101:for(var g=c(t),a=e.state.memory,r=e.state.V,n=e.state.I,V=101==(255&t),I=0;I<=g;I++)V?r[I]=a[n+I]:a[n+I]=r[I];return void(e.state.I+=g+1)}break;default:console.log("invalid opcode: "+t+"!")}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.chars=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128],e.keys="1234qwerasdfzxcv".split("")}],[0]);
//# sourceMappingURL=client.e7d4ebc2.js.map